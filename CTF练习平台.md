## 简介

`CTF`（`Capture The Flag`，夺旗赛）`CTF` 的前身是传统黑客之间的网络技术比拼游戏，起源于 1996 年第四届 `DEFCON`，以代替之前黑客们通过互相发起真实攻击进行技术比拼的方式。` CTF`是一种流行的信息安全竞赛形式，其英文名可直译为“夺得Flag”，也可意译为“夺旗赛”。其大致流程是，参赛团队之间通过进行攻防对抗、程序分析等形式，率先从主办方给出的比赛环境中得到一串具有`一定格式的字符串`或其他内容，并将其提交给主办方，从而夺得分数。为了方便称呼，我们把这样的内容称之为“Flag”。 flag所表示的为目标服务器上存储的一些`敏感机密`的信息, 这些信息正常情况下是不能对外暴露的。选手利用目标的一些漏洞，获取到flag，其表示的即为在真实的黑客攻击中窃取到的机密信息。 一般情况下flag拥有固定格式为`flag{xxxxx}`，有些比赛会把flag关键词替换，例如我们CTFHub平台的flag为`ctfhub{xxxxx}`，利用固定格式来反推flag也是一种常见的解题思路 通常来说CTF是以团队为单位进行参赛。每个团队3-5人(具体根据主办方要求决定)，在整个比赛过程中既要每个选手拥有某个方向的漏洞挖掘能力，也要同队选手之间的相互配合。



# 学习知识栈

## 课程大纲

### CTF之WEB安全入门

1 .CTF简介

1.1 CTF-Web介绍 

1.2 CTF中的常用工具 

1.3 CTF中Web trick

2. Web安全 - 服务端漏洞

2.1 SQL注入攻击与防御

2.2 代码执行

2.3 文件上传

2.4 命令执行

2.5 文件包含

2.6 任意文件下载

2.7 认证与会话管理

3 .Web安全 - 客户端漏洞

3.1 XSS漏洞挖掘与利用

3.2 CSRF利用

3.3 域、同源策略

3.4 jsonp以及CORS

3.5 挑战CSP以及沙箱

4. Web安全 - 代码审计

4.1 PHP代码审计

4.2 Python代码审计

5. Web安全 - 内网渗透

5.1信息收集

5.2 端口转发&&边界代理

5.3 MSF 内网渗透

5.4 提权

5.5 密码抓取

6. Web安全 - AWD介绍

6.1 简介

6.2 批量攻击

6.3 权限维持

6.4 防守



### CTF之逆向分析技术

1. 逆向工程简介和基础工具介绍

2. PE\ELF软件逆向和MFC逆向

3. 加解密算法逆向

4. X86软件的加壳与脱壳

5. 混淆、花指令和反调试

6. 安卓、wasm和其他软件的逆向



### CTF之PWN入门

1. 环境搭建

1.1 通过Docker搭建环境

1.2 熟悉工具

2. 二进制基础

2.1 基本汇编指令

2.2 函数调用

2.3 保护方式与原理

3. 栈溢出原理

3.1 栈溢出基本原理

3.2 ROP技术

3.3 ret2text

3.4 ret2shellcode

3.5 ret2syscall

3.6 ret2libc



### CTF之密码学基础

1. 古典密码

1.1 凯撒密码

1.2 维吉尼亚密码

1.3 栅栏密码

2. 对称密码

2.1 DES

2.2 AES

2.3加密模式

3. 非对称密码

3.1 RSA

3.2 ElGamal

4. 哈希函数与签名

4.1 MD5、SHA1

4.2 数字签名介绍

# 竞赛模式

### 理论知识

理论题多见于国内比赛，通常为选择题。包含单选及多选，选手需要根据自己所学的相关理论知识进行作答。最终得出分数。理论部分通常多见于初赛或是初赛之前的海选

------

### Jeopardy-解题

参赛队伍可以通过互联网或者现场网络参与，参数队伍通过与在线环境交互或文件离线分析，解决网络安全技术挑战获取相应分值，类似于 ACM 编程竞赛、信息学奥林匹克赛，根据总分和时间来进行排名。

不同的是这个解题模式一般会设置 一血(First Blood) 、 二血(Second Blood) 、 三血(Third Blood) ，也即最先完成的前三支队伍会获得额外分值，所以这不仅是对首先解出题目的队伍的分值鼓励，也是一种团队能力的间接体现。

当然还有一种流行的计分规则是设置每道题目的初始分数后，根据该题的成功解答队伍数，来逐渐降低该题的分值，也就是说如果解答这道题的人数越多，那么这道题的分值就越低。最后会下降到一个保底分值后便不再下降。一般称之为`动态积分`

题目类型主要包含 Web 网络攻防 、 RE 逆向工程 、 Pwn 二进制漏洞利用 、 Crypto 密码攻击以及 Misc 安全杂项 这五个类别，个别比赛会根据题目类型进行扩展。

------

### AwD-攻防模式

**A**ttack **w**ith **D**efense(AwD)全称攻防模式，在攻防模式CTF赛制中，参赛队伍连接到同一个网络空间。主办方会预先为每个参赛队分配要防守的主机，该主机称之为`GameBox`，每个队伍之间的GameBox`配置及漏洞是完全一致`的，选手需要防护自己的GameBox不被攻击的同时挖掘漏洞并攻击对手服务来得分。在AwD中主办方会运行一个名为`Checker`的程序定时检测选手的GameBox的运行状态。若检测到状态不对则判定该GameBox宕机，按照规则扣除一定分数。攻防模式CTF赛制可以实时通过得分反映出比赛情况，最终也以得分直接分出胜负，是一种竞争激烈，具有很强观赏性和高度透明性的网络安全赛制。在这种赛制中，不仅仅是比参赛队员的智力和技术，也比体力（因为比赛一般都会持续24至48小时左右），同时也比团队之间的分工配合与合作。 AwD通常仅包含`Web`及`Pwn`两种类型的题目。每个队伍可能会分到多个GameBox，随着比赛的进行，最早的GameBox可能会下线，同时会上线新的GameBox。

------

### RHG-自动化[ AI自动化]

**R**obo **H**acking **G**ame(RHG)该利用人工智能或是AI或是自动化攻击程序来全自动的挖掘并利用漏洞，考验选手对于`漏洞理解`以及`工程化`能力。比赛开始前(一般为1-4周左右)主办方会给出测试环境以及相关接口文档。选手需要编写自动化程序来请求接口获取题目相关信息，该类程序通常称之为`bot`，在程序中`全自动`访问并挖掘目标漏洞，完成利用漏洞攻击并获取flag的过程。获取到的flag也由程序自动化提交。RHG因为是由bot全自动进行工作，所以比赛开始即可视为结束。剩下的一切全看参赛选手编写的自动化bot的工作情况。 比赛过程中不允许选手对bot进行任何的操作(包括debug/patch等等)。选手仅能看到自己的bot完成了哪些题。目前的得分情况等等。

------

### RW-真实世界

Real World(`RW`) 首次于2018年`长亭科技`主办的`RealWorldCTF`中出现，该赛制着重考察选手在面对真实的环境下的漏洞挖掘与利用能力。通常`RW`模式出题也会围绕着能够应用于真实渗透攻击当中的漏洞，一般来说`RW`常见题型为`VM`/`Docker`逃逸、针对浏览器的攻击、针对`IoT`/`Car`等设备的攻击，`Web`类攻击等等 在`RW`赛制中会有一个`Show Time`，当选手认为自己已经可以完成题目时，选手可以在比赛平台上提交展示申请，由工作人员根据申请先后顺序进行展示排期。选手展示之前需要上台并连接相关网络，同时现场大屏会切换至目标的正常页面。选手确认连接并测试OK之后开始计时。一般情况下上台攻击的时间为5分钟，选手一旦完成攻击现场大屏幕会实时看到攻击的效果，此时裁判会根据效果是否符合题目要求来判定该题是否完成。如5在攻击时间内依然未能看到展示效果则认为本次攻击失败。现如今为了防止选手恶意排期。通常会有一个队伍总展示次数(例如在2019年数字经济云安全公测大赛中每个队伍只允许上台展示30次)，选手也需要尽可能保证上台之后攻击的成功率 举个例子。题目要求需要攻击位于比赛网络中的某个网站并将首页替换为包含队伍名称的页面。题目给出该网站的一些信息(源代码/数据库等等)，选手经过本地挖掘漏洞之后，提交展示申请，排期到了之后进行上台展示。注意，因为`RW`模式是以展示效果来作为题目是否完成的准则，所以在`RW`模式中并不存在Flag。

------

### KoH-抢占山头

**K**ing **o**f **H**ill(KoH)是近些年新衍生的一种赛制。该赛制有点类似于AwD，但是又和AwD有些不一样。选手面对的是一个黑盒的目标，需要先挖掘漏洞并利用漏洞控制目标。将自己的队伍标识(`队伍名称`或是`Token`之类)写入到指定文件。随后在该主机上进行加固等操作防止其他队伍攻击，主办方会定期去检查标识文件，根据文件中的队伍标识来判定本回合分数给予哪个队伍。可以看出KoH也是一种对抗极为激烈的赛制，同时考察选手的渗透能力及防御加固能力。

------

### Mix[混合]

混合模式结合了以上多种模式，现如今单一的赛制已经无法满足比赛及选手的参赛需求，所以大部分比赛会同时以多个模式进行比赛。例如参赛队伍通过解题(Jeopardy)可以获取一些初始分数，然后通过攻防对抗(AwD)进行得分增减的零和游戏，最终以得分高低分出胜负。





# OJ平台

**在线判题系统**（[英语](https://baike.baidu.com/item/英语/109997)：**Online Judge**，缩写**OJ**）是一种在[编程](https://baike.baidu.com/item/编程/139828)竞赛中用来测试参赛程序的在线系统，也可以用于平时练习。许多OJ网站会自发组织一些竞赛。

OJ系统能够编译并执行[代码](https://baike.baidu.com/item/代码)，使用预设的数据对这些程序进行测试。提交的代码一般会在受限的环境下运行，包括时间限制、内存限制、安全限制等。代码的输出会被OJ系统捕获，与标准答案进行比较后返回结果。

OJ网站会对用户进行排名，以用户的提交答案通过数多少或某个题目执行时间快慢为排名依据。



[ctftime](https://ctftime.org/) [buuoj](https://buuoj.cn/) [ctf.pediy](https://ctf.pediy.com/) [xctf.org](https://www.xctf.org.cn/) [ctfhub](https://www.ctfhub.com/)

除以上平台还有安恒、合安信、攻防世界等平台也经常会有线上或刷题途径

oj中题目通常提供writeup，如没有的也通常在百度中可得